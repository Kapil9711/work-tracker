import{r as c,j as e,a as N,A as b,m as y,n as k,e as u,u as U,o as I}from"./index-iTZG_CXf.js";import{M as C}from"./Modal-KtViZ_xK.js";import{L as D,N as d}from"./Toasts-wLaCnDvT.js";import"./DashboardPage-DyKd9pmP.js";import"./styled-components.browser.esm-DYxTFAtm.js";const f=c.forwardRef(({children:s},t)=>e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{className:"text-2xl",htmlFor:"name",children:s}),e.jsx("input",{ref:t,className:"w-full text-black tracking-wider font-bold  text-xl border-l-4 border-r-4 border-t-2 border-b-2 border-black rounded-lg focus:outline-none px-4 h-12",type:"text",id:"name"})]}));f.displayName="UpdatePassword";const R=({usernameRef:s})=>e.jsxs("div",{className:"flex flex-col gap-2 ",children:[e.jsx("label",{className:"text-2xl",htmlFor:"name",children:"Username"}),e.jsx("input",{ref:s,className:"w-full text-black tracking-wider font-bold  text-xl border-l-4 border-r-4 border-t-2 border-b-2 border-black rounded-lg focus:outline-none px-4 h-12",type:"text",id:"name"})]}),F=({setFile:s})=>e.jsxs("div",{className:"flex flex-col gap-2 ",children:[e.jsx("label",{className:"text-2xl",htmlFor:"name",children:"Select Image"}),e.jsx("input",{type:"file",onChange:t=>{s(t.target.files[0])}})]}),S=({user:s,setActive:t})=>e.jsxs(e.Fragment,{children:[e.jsxs("h3",{className:"font-bold text-2xl text-center pt-4",children:["Hello! ",s.username]}),e.jsxs("div",{className:"grid gap-5 px-10 py-4  w-full  mx-auto mt-5 ",children:[e.jsx(x,{heading:"Username",setActive:t}),e.jsx(x,{heading:"Password",setActive:t}),e.jsx(x,{heading:"ProfileImg",setActive:t})]})]}),x=({heading:s,setActive:t})=>e.jsxs("div",{className:"flex  justify-between items-center",children:[e.jsx("h2",{className:"text-xl tracking-wide text-white font-bold",children:s}),e.jsx("button",{onClick:()=>t(s),className:"btn btn-xs btn-accent bg-violet-400 hover:bg-violet-500 ",children:"update"})]}),L=({user:s})=>{const t=N(),[a,o]=c.useState(""),[n,l]=c.useState(!1),[i,m]=c.useState(null),r=c.useRef(null),p=c.useRef(null),g=c.useRef(null),v=async P=>{var h;if(P.preventDefault(),l(!0),a==="ProfileImg")await O(i,l,t);else{let w={username:(h=r.current)==null?void 0:h.value},j="/profile/update";a==="Password"&&(w={oldPassword:p.current.value,newPassword:g.current.value},j="/password/update"),await E(a,w,j,l,t)}};return e.jsxs("div",{className:"setting  bg-[#f57156] max-w-[500px] mx-auto mt-16 sm:mt-8 border-t-8 border-b-8  rounded-3xl border-black shadow-lg shadow-black sm:pb-8 pb-16",children:[e.jsx(S,{user:s,setActive:o}),a&&e.jsxs("div",{className:"forms",children:[e.jsx("p",{className:"text-center font-bold tracking-wide mb-4  text-2xl",children:a}),e.jsxs("form",{onSubmit:v,className:"form1  border-t-4 border-b-4 shadow-lg shadow-black rounded-3xl border-black bg-[#f46748] max-w-96 mx-auto px-5 py-5",children:[a==="Username"&&e.jsx(R,{usernameRef:r}),a==="ProfileImg"&&e.jsx(F,{setFile:m}),a==="Password"&&e.jsxs(e.Fragment,{children:[e.jsx(f,{ref:p,children:"Old Password"}),e.jsx(f,{ref:g,children:"New Password"})]}),n?e.jsx("div",{className:"flex justify-center h-16",children:e.jsx(D,{})}):e.jsx("button",{className:"btn block btn-accent btn-sm bg-violet-400 hover:bg-violet-500   mx-auto mt-5",children:"Update"})]})]})]})},O=async(s,t,a)=>{if(!s)return d("warning","please select a image"),t(!1);const o=new FormData;o.append("image",s);const n=await b.uploadImage("/image",o);n.success?(d("success",n.message),a(y())):d("error",n.message),t(!1)},E=async(s,t,a,o,n)=>{const l=await b.updateProfile(a,t);if(l.success){if(o(!1),s==="Password")return d("success","Password updated successfully");d("success","Username updated successfully"),n(k(l.data))}else d("error",l.message),o(!1)},q=()=>{const s=u(r=>r.user.value),t=u(r=>r.user.image),a=u(r=>r.user.key),o=N(),[n,l]=c.useState(!1),i=U();c.useEffect(()=>{o(I())},[]);const m=async()=>{const r=await b.logoutUser();r.success?(d("success","Logout successfull"),i("/")):d("error",r.message)};return e.jsxs("div",{className:"dropdown dropdown-hover ",children:[e.jsxs("div",{tabIndex:0,role:"button",className:"btn btn-ghost  text-white text-xl m-1",children:[e.jsx("img",{className:"rounded-full w-11 h-11",src:t,alt:"starImg"},a),e.jsx("span",{className:"hidden sm:block",children:s.username})]}),e.jsxs("ul",{tabIndex:0,className:"dropdown-content bg-white -ml-36 sm:ml-0 menu  rounded-box z-[1] w-52 p-2 shadow",children:[e.jsx("li",{className:"btn btn-ghost text-xl hover:bg-gray-200",onClick:()=>l(!0),children:"Profile"}),e.jsx("li",{className:"btn btn-ghost text-sm flex gap-2 hover:bg-gray-200",onClick:m,children:"Log Out"}),n&&e.jsx(C,{setIsOpen:l,children:e.jsx(L,{user:s})})]})]})};export{q as default};
